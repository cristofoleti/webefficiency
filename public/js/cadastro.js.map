{"version":3,"sources":["cadastro.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cadastro.js","sourcesContent":["$(function () {\r\n\r\n    //-- CADASTRO\r\n\r\n    var modal = $('.modal_cadastro');\r\n    var save_history_url = '';\r\n    var loaded = false;\r\n\r\n    //open page actions\r\n    modal.on('click','.btn-modal-nav, .btn-back', function(e){\r\n\r\n        var url = $(this).attr('data-page');\r\n\r\n        if($(this).hasClass('loadUsers')){\r\n            save_history_url = url;\r\n            loadUsers(url);\r\n        }\r\n        else if(url != \"\"){\r\n            e.preventDefault();\r\n\r\n            $.ajax({\r\n                method: 'get',\r\n                url: url,\r\n                success: function(data){\r\n                    var content = modal.find('#load_content');\r\n                    content.html(data);\r\n\r\n                    if(content.find('#frmUser').length > 0 && save_history_url != \"\"){\r\n                        content.find('.btn-back.btn-admin').attr('data-page', save_history_url);\r\n                    }\r\n                    \r\n                },\r\n                error: function(xhr){\r\n                    debug(xhr);\r\n                }\r\n            });\r\n\r\n        }\r\n    });\r\n\r\n\r\n    //submit form\r\n    modal.on('submit', 'form:not(.form-button-delete)', function(e){\r\n        e.preventDefault();\r\n\r\n        var form = $(this).closest('form');\r\n        var alert = form.find('.alert');\r\n\r\n        //validate\r\n        if( form.find('[required=\"required\"]').filter(function(){ return $(this).val() == \"\"; }).length > 0 ){\r\n            alert.text('Preencha os campos obrigat√≥rios');\r\n        }else{\r\n\r\n            //save\r\n            $.ajax({\r\n                cache: false,\r\n                method: 'post',\r\n                url: form.attr('action'),\r\n                data: form.serialize(),\r\n                success: function(data, textStatus, xhr){\r\n                    if(typeof data == 'object' || data == true){\r\n                        alert.html('Salvo com sucesso!');\r\n                        //clear form\r\n                        if(form.hasClass('cadastrar')) clearForm(form);\r\n                    }\r\n                },\r\n                error: function(xhr){\r\n                    if(xhr.status == '422' && typeof xhr.responseJSON == 'object'){\r\n                        var arr = [];\r\n                        $.each(xhr.responseJSON, function( index, value ) {\r\n                            arr.push(value);\r\n                        });\r\n                        alert.html(arr.join('<br/>'));\r\n                    }\r\n                    else if(xhr.status == '500'){\r\n                        debug(xhr);\r\n                        alert.html('Desculpe, ocorreu um erro.');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n    });\r\n\r\n\r\n    //delete item\r\n    modal.on('submit', '.form-button-delete', function(e){\r\n        e.preventDefault();\r\n\r\n        var form = $(this);\r\n\r\n        $.ajax({\r\n            cache: false,\r\n            method: 'post',\r\n            url: form.attr('action'),\r\n            data: form.serialize(),\r\n            success: function(data){\r\n                form.closest('tr').hide(0);\r\n            },\r\n            error: function(xhr){\r\n                debug(xhr);\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n\r\n\r\n});\r\n\r\nfunction clearForm(form){\r\n    form.find('input:not(input[type=\"checkbox\"], input[type=\"radio\"]), textarea').val('');\r\n    form.find('input[type=\"checkbox\"], input[type=\"radio\"]').removeAttr('checked');\r\n    form.find('select option').removeAttr('selected');\r\n}\r\n\r\nfunction loadCompanies(){\r\n    $.ajax({\r\n        cache: false,\r\n        url: '/companies',\r\n        success: function(data){\r\n            //console.log(data);\r\n            $('#load_content').html(data);\r\n            loaded = 'companies';\r\n        },\r\n        error: function(xhr){\r\n            debug(xhr);\r\n        }\r\n    });\r\n\r\n}\r\n\r\nfunction loadUsers(url_by_company){\r\n    if(url_by_company == '' || url_by_company == undefined) url_by_company = '/users';\r\n    $.ajax({\r\n        cache: false,\r\n        url: url_by_company,\r\n        success: function(data){\r\n            //console.log(data);\r\n            $('#load_content').html(data);\r\n            loaded = 'users';\r\n        },\r\n        error: function(xhr){\r\n            debug(xhr);\r\n        }\r\n    });\r\n}\r\n\r\nfunction loadGroups(){\r\n    $.ajax({\r\n        cache: false,\r\n        url: '/groups',\r\n        success: function(data){\r\n            //console.log(data);\r\n            $('#load_content').html(data);\r\n            loaded = 'groups';\r\n        },\r\n        error: function(xhr){\r\n            debug(xhr);\r\n        }\r\n    });\r\n}\r\n\r\nfunction debug(xhr){\r\n    console.log(xhr);\r\n    var strip_tags = xhr.responseText.replace(/(<([^>]+)>)/ig,\"\");\r\n    console.log(strip_tags);\r\n}"],"sourceRoot":"/source/"}